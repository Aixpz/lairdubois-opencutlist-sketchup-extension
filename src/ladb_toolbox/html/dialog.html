<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/bootstrap-select.min.css">
    <link rel="stylesheet" href="../css/ladb-toolbox.css">
    <link rel="stylesheet" href="../css/ladb_icons.css">
</head>
<body>
    <script type="text/javascript">
        window.onerror = function (errorMsg, url, lineNumber) {
            alert('Error: ' + errorMsg + '\n Script: ' + url + '\n Line: ' + lineNumber);
        };
    </script>
    <script src="../js/lib/jquery-3.1.1.min.js"></script>
    <script src="../js/lib/jquery-ui.min.js"></script>
    <script src="../js/lib/bootstrap.min.js"></script>
    <script src="../js/lib/bootstrap-select.min.js"></script>
    <script src="../js/lib/twig.min.js"></script>
    <script src="../js/lib/base64.min.js"></script>
    <script src="../js/plugins/jquery.ladb.toolbox.js"></script>
    <script src="../js/plugins/jquery.ladb.tab-cutlist.js"></script>
    <script src="../js/plugins/jquery.ladb.tab-materials.js"></script>
    <script src="../js/plugins/jquery.ladb.tab-about.js"></script>
    <script src="../js/templates/twig-templates.js"></script>
    <script type="text/javascript">

        // Ruby JS interactions

        var commandId = 0;
        var commandCallbacks = {};

        function rubyCallCommand(command, params, callback) {
            var call = {
                id: commandId,
                command: command,
                params: params
            };
            commandCallbacks[commandId] = callback;
            commandId++;
            window.location.href = "skp:ladb_toolbox_command@" + JSON.stringify(call);
        }

        function rubyCommandCallback(id, encodedData) {
            var callback = commandCallbacks[id];
            if (callback) {
                if (callback) {
                    var data = encodedData ? JSON.parse(decodeURIComponent(Base64.decode(encodedData))) : {};
                    callback(data);
                    commandCallbacks[id] = null;
                }
            }
        }

        // Ready !

        $(document).ready(function () {
            rubyCallCommand('dialog_loaded', null, function(data) {
                $('body').ladbToolbox(data);
            });
        });

    </script>
</body>
</html>
