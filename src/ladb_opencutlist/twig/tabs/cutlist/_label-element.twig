{% set terms = (elementDef.formula)|split('.') %}
{% if terms[0] == 'part' %}
    {% set key = terms[1] %}
    {% if key == 'cutting_size' %}
        {% set value = part_info.part.cutting_length~' x '~part_info.part.cutting_width %}
    {% elseif key == 'size' %}
        {% set value = part_info.part.length~' x '~part_info.part.width %}
    {% elseif key == 'batch' %}
        {% set value = part_info.position_in_batch~'/'~part_info.part.count %}
    {% else %}
        {% set value = part_info.part[key] %}
    {% endif %}
{% elseif terms[0] == 'group' %}
    {% set key = terms[1] %}
    {% if key == 'material' %}
        {% set value = group.material_name~' / '~group.std_dimension %}
    {% else %}
        {% set value = group[key] %}
    {% endif %}
{% elseif terms[0] == 'filename' %}
    {% set value = filename %}
{% elseif terms[0] == 'page_label' %}
    {% set value = pageLabel %}
{% elseif terms[0] == 'length_unit' %}
    {% set value = ('default.unit_'~lengthUnit)|i18next %}
{% elseif terms[0] == 'generated_at' %}
    {% set value = generatedAt|date(('default.date_format'|i18next())) %}
{% endif %}
{% if value is empty and noEmptyValue|default(false) %}
    {% set value = '['~elementDef.formula~']' %}
{% endif %}
<text x="0" y="0" font-size="{{ elementDef.fontSize * minUnit }}" text-anchor="{{ elementDef.textAnchor }}" fill="{{ elementDef.color }}">{{ value }}</text>
